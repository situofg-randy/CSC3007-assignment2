{"ast":null,"code":"var _jsxFileName = \"/Users/angrandy/Desktop/CSC3007-assignment2/src/StackedBarChart.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef } from \"react\";\nimport { select, scaleBand, axisBottom, stack, max, scaleLinear, axisLeft, stackOrderAscending, pointer } from \"d3\";\nimport useResizeObserver from \"./useResizeObserver\";\n/**\n * Component that renders a StackedBarChart\n */\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction StackedBarChart(_ref) {\n  _s();\n\n  let {\n    data,\n    keys,\n    colors\n  } = _ref;\n  const svgRef = useRef();\n  const wrapperRef = useRef();\n  const dimensions = useResizeObserver(wrapperRef);\n  var tooltip = select(\"#tooltip\").append(\"div\").style(\"opacity\", 0).attr(\"class\", \"tooltip\").style(\"background-color\", \"white\").style(\"border\", \"solid\").style(\"border-width\", \"1px\").style(\"border-radius\", \"5px\").style(\"padding\", \"10px\");\n\n  var mouseover = function (d) {\n    var subgroupName = select(this.parentNode).datum().key;\n    tooltip.html(\"subgroup: \" + subgroupName).style(\"opacity\", 1);\n  };\n\n  var mousemove = function (d) {\n    tooltip.style(\"left\", pointer(this)[0] + 90 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\n    .style(\"top\", pointer(this)[1] + \"px\");\n  };\n\n  var mouseleave = function (d) {\n    tooltip.style(\"opacity\", 0);\n  }; // will be called initially and on every data change\n\n\n  useEffect(() => {\n    const svg = select(svgRef.current);\n    const {\n      width,\n      height\n    } = dimensions || wrapperRef.current.getBoundingClientRect(); // stacks / layers\n\n    const stackGenerator = stack().keys(keys).order(stackOrderAscending);\n    const layers = stackGenerator(data);\n    console.log(layers);\n    const extent = [0, max(layers, layer => max(layer, sequence => sequence[1]))]; // scales\n\n    const xScale = scaleBand().domain(data.map(d => d.year)).range([0, width]).padding(0.25);\n    const yScale = scaleLinear().domain(extent).range([height, 0]); // rendering\n\n    svg.selectAll(\".layer\").data(layers).join(\"g\").attr(\"class\", \"layer\").attr(\"fill\", layer => colors[layer.key]).selectAll(\"rect\").data(layer => layer).join(\"rect\").attr(\"x\", sequence => xScale(sequence.data.year)).attr(\"width\", xScale.bandwidth()).attr(\"y\", sequence => yScale(sequence[1])).attr(\"height\", sequence => yScale(sequence[0]) - yScale(sequence[1])).on(\"mouseover\", (event, d) => {\n      select(\".tooltip\").text(\"Year: \" + d.data.year + \" Murder: \" + d.data.Murder + \" Outrage Of Modesty: \" + d.data[\"Outrage Of Modesty\"] + \" Housebreaking: \" + d.data[\"Housebreaking\"] + \" Cheating Related Offences: \" + d.data[\"Cheating Related Offences\"] + \" Rape: \" + d.data[\"Rape\"] + \" Rioting: \" + d.data[\"Rioting\"] + \" Robbery: \" + d.data[\"Robbery\"] + \" Serious Hurt: \" + d.data[\"Serious Hurt\"] + \" Snatch Theft: \" + d.data[\"Snatch Theft\"] + \" Theft Of Motor Vehicle \" + d.data[\"Theft Of Motor Vehicle\"]).style(\"position\", \"absolute\").style(\"background\", \"#fff\").style(\"left\", event.pageX + \"px\").style(\"top\", event.pageY + \"px\");\n      select(event.currentTarget).classed(\"selected\", true);\n    }).on(\"mouseout\", (event, d) => {\n      select(\".tooltip\").text(\"\");\n      select(event.currentTarget).classed(\"selected\", false);\n    }); // axes\n\n    const xAxis = axisBottom(xScale);\n    svg.select(\".x-axis\").attr(\"transform\", `translate(0, ${height})`).call(xAxis);\n    const yAxis = axisLeft(yScale);\n    svg.select(\".y-axis\").call(yAxis);\n  }, [colors, data, dimensions, keys]);\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"tooltip\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: wrapperRef,\n      style: {\n        marginBottom: \"2rem\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        ref: svgRef,\n        children: [/*#__PURE__*/_jsxDEV(\"g\", {\n          className: \"x-axis\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"g\", {\n          className: \"y-axis\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 5\n  }, this);\n}\n\n_s(StackedBarChart, \"6bFCyBd3HKwDD6FYD4wxcBmp2CY=\", false, function () {\n  return [useResizeObserver];\n});\n\n_c = StackedBarChart;\nexport default StackedBarChart;\n\nvar _c;\n\n$RefreshReg$(_c, \"StackedBarChart\");","map":{"version":3,"names":["React","useEffect","useRef","select","scaleBand","axisBottom","stack","max","scaleLinear","axisLeft","stackOrderAscending","pointer","useResizeObserver","StackedBarChart","data","keys","colors","svgRef","wrapperRef","dimensions","tooltip","append","style","attr","mouseover","d","subgroupName","parentNode","datum","key","html","mousemove","mouseleave","svg","current","width","height","getBoundingClientRect","stackGenerator","order","layers","console","log","extent","layer","sequence","xScale","domain","map","year","range","padding","yScale","selectAll","join","bandwidth","on","event","text","Murder","pageX","pageY","currentTarget","classed","xAxis","call","yAxis","marginBottom"],"sources":["/Users/angrandy/Desktop/CSC3007-assignment2/src/StackedBarChart.js"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport {\n  select,\n  scaleBand,\n  axisBottom,\n  stack,\n  max,\n  scaleLinear,\n  axisLeft,\n  stackOrderAscending,\n  pointer\n} from \"d3\";\nimport useResizeObserver from \"./useResizeObserver\";\n\n/**\n * Component that renders a StackedBarChart\n */\n\nfunction StackedBarChart({ data, keys, colors }) {\n  const svgRef = useRef();\n  const wrapperRef = useRef();\n  const dimensions = useResizeObserver(wrapperRef);\n\n  var tooltip = select(\"#tooltip\")\n    .append(\"div\")\n    .style(\"opacity\", 0)\n    .attr(\"class\", \"tooltip\")\n    .style(\"background-color\", \"white\")\n    .style(\"border\", \"solid\")\n    .style(\"border-width\", \"1px\")\n    .style(\"border-radius\", \"5px\")\n    .style(\"padding\", \"10px\")\n\n  var mouseover = function(d) {\n    var subgroupName = select(this.parentNode).datum().key;\n    \n    tooltip\n        .html(\"subgroup: \" + subgroupName)\n        .style(\"opacity\", 1)\n  }\n\n  var mousemove = function(d) {\n    tooltip\n      .style(\"left\", (pointer(this)[0]+90) + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\n      .style(\"top\", (pointer(this)[1]) + \"px\")\n  }\n  var mouseleave = function(d) {\n    tooltip\n      .style(\"opacity\", 0)\n  }\n\n  // will be called initially and on every data change\n  useEffect(() => {\n    const svg = select(svgRef.current);\n    const { width, height } =\n      dimensions || wrapperRef.current.getBoundingClientRect();\n\n    // stacks / layers\n    const stackGenerator = stack()\n      .keys(keys)\n      .order(stackOrderAscending);\n    const layers = stackGenerator(data);\n    console.log(layers)\n\n    const extent = [\n      0,\n      max(layers, layer => max(layer, sequence => sequence[1]))\n    ];\n\n    // scales\n    const xScale = scaleBand()\n      .domain(data.map(d => d.year))\n      .range([0, width])\n      .padding(0.25);\n\n    const yScale = scaleLinear()\n      .domain(extent)\n      .range([height, 0]);\n\n    // rendering\n    svg\n      .selectAll(\".layer\")\n      .data(layers)\n      .join(\"g\")\n      .attr(\"class\", \"layer\")\n      .attr(\"fill\", layer => colors[layer.key])\n      .selectAll(\"rect\")\n      .data(layer => layer)\n      .join(\"rect\")\n      .attr(\"x\", sequence => xScale(sequence.data.year))\n      .attr(\"width\", xScale.bandwidth())\n      .attr(\"y\", sequence => yScale(sequence[1]))\n      .attr(\"height\", sequence => yScale(sequence[0]) - yScale(sequence[1]))\n      .on(\"mouseover\", (event, d) => {\n        select(\".tooltip\")\n        .text(\"Year: \" + d.data.year + \" Murder: \" + d.data.Murder + \" Outrage Of Modesty: \" + d.data[\"Outrage Of Modesty\"] + \" Housebreaking: \" + d.data[\"Housebreaking\"] + \" Cheating Related Offences: \" + d.data[\"Cheating Related Offences\"] + \" Rape: \" + d.data[\"Rape\"] + \" Rioting: \" + d.data[\"Rioting\"] + \" Robbery: \" + d.data[\"Robbery\"] + \" Serious Hurt: \" + d.data[\"Serious Hurt\"] +  \" Snatch Theft: \" + d.data[\"Snatch Theft\"] + \" Theft Of Motor Vehicle \" + d.data[\"Theft Of Motor Vehicle\"])\n        .style(\"position\", \"absolute\")\n        .style(\"background\", \"#fff\")\n        .style(\"left\", (event.pageX) + \"px\")\n        .style(\"top\", (event.pageY) + \"px\");\n\n        select(event.currentTarget).classed(\"selected\", true)\n    })\n    .on(\"mouseout\", (event, d) => {\n      select(\".tooltip\")\n      .text(\"\");\n\n      select(event.currentTarget).classed(\"selected\", false)\n  })\n\n    // axes\n    const xAxis = axisBottom(xScale);\n    svg\n      .select(\".x-axis\")\n      .attr(\"transform\", `translate(0, ${height})`)\n      .call(xAxis);\n\n    const yAxis = axisLeft(yScale);\n    svg.select(\".y-axis\").call(yAxis);\n  }, [colors, data, dimensions, keys]);\n\n  return (\n    <React.Fragment>\n      <div class=\"tooltip\"></div>\n      <div ref={wrapperRef} style={{ marginBottom: \"2rem\" }}>\n        <svg ref={svgRef}>\n          <g className=\"x-axis\" />\n          <g className=\"y-axis\" />\n        </svg>\n      </div>\n    </React.Fragment>\n  );\n}\n\nexport default StackedBarChart;"],"mappings":"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"},"metadata":{},"sourceType":"module"}